<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Text Length Calculator</title>

  <!-- using uploaded local file as favicon (path provided) -->
  <link rel="icon" href="/mnt/data/5cf7c5e7-d3fa-4831-953f-0438b660ea44.png" />

  <style>
/* ----------  CSS - <style> ---------- */

/* Theme variables (light & dark) */
:root{
  --bg:#f7fbfc;
  --card:#ffffff;
  --text:#0f172a;
  --muted:#6b7280;
  --accent:#0ea5a4;
  --stat-bg:#f1fbfb;
  --shadow:0 6px 20px rgba(12,20,30,0.06);
}

.theme-dark{
  --bg:#071019;
  --card:#07161c;
  --text:#e6eef6;
  --muted:#94a3b8;
  --accent:#22d3ee;
  --stat-bg:#08323b;
  --shadow:0 6px 20px rgba(0,0,0,0.6);
}

/* Base layout - use flex column so card fills viewport and inner textarea can scroll */
html, body {
  height: 100%;
  margin: 0;
}

body {
  font-family: Inter, ui-sans-serif, system-ui, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background: var(--bg);
  color: var(--text);
  /* keep page from scrolling, but let card manage internal scrolling */
  overflow: hidden;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* Make wrap fill viewport height and center card vertically with safe gaps */
.wrap {
  max-width: 1000px;
  margin: 20px auto;
  padding: 0;
  height: calc(100vh - 40px); /* account for top/bottom margins */
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Title spacing stays outside card so it doesn't push content away */
h1 {
  font-size: 34px;
  margin: 0 0 8px;
}

/* Card becomes a column flex that can grow/shrink */
.card {
  background: var(--card);
  border-radius: 12px;
  padding: 18px;
  box-shadow: var(--shadow);
  display: flex;
  flex-direction: column;
  gap: 12px;
  /* make card take remaining height inside .wrap so inner layout is stable */
  flex: 1 1 auto;
  min-height: 0; /* important for children to be able to scroll */
  box-sizing: border-box;
}

/* Textarea fills the available space inside card and scrolls internally when needed */
textarea {
  width: 100%;
  flex: 1 1 auto;      /* take remaining vertical space */
  min-height: 120px;   /* small screens */
  border: 1px solid rgba(0,0,0,0.06);
  border-radius: 8px;
  padding: 14px;
  font-size: 15px;
  resize: none;        /* no manual resize */
  line-height: 1.45;
  overflow: auto;      /* internal scroll if content exceeds textarea height */
  box-sizing: border-box;
  background: transparent;
  color: var(--text);
}

/* controls and buttons */
.controls {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 0;
}

button {
  background: var(--accent);
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
}

button.ghost {
  background: transparent;
  color: var(--accent);
  border: 1px solid rgba(14,165,164,0.12);
}

.toggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: transparent;
  border: 1px solid rgba(0,0,0,0.06);
  padding: 6px 10px;
  border-radius: 999px;
  cursor: pointer;
  color: var(--muted);
  font-size: 13px;
}

/* stats */
.stats {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 6px;
}

.stat {
  background: var(--stat-bg);
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid rgba(14,165,164,0.06);
  min-width: 140px;
  color: var(--text);
}

.stat strong { display:block; font-size:18px; }

.muted { color: var(--muted); font-size:13px; }
.right { margin-left:auto; color:var(--muted); }

.footer {
  margin-top: 6px;
  font-size: 13px;
  color: var(--muted);
}

/* mobile */
@media (max-width:520px) {
  .wrap { height: auto; padding: 12px; }
  .controls { flex-direction: column; align-items: stretch; }
  .stat { min-width: 120px; }
  textarea { min-height: 160px; }
}

/* ---------- end  CSS ---------- */

  </style>
</head>

<body>
  <div id="app" class="">
    <div class="wrap">
      <h1>Text length calculator</h1>

      <div class="card">
        <label for="txt" class="muted">
          Paste or type any text below â€” there's no length limit enforced by this tool.
        </label>

        <textarea id="txt" placeholder="Start typing or paste text here..."></textarea>

        <div class="controls">
          <div style="display:flex; gap:8px; align-items:center;">
            <button id="copy">Copy</button>
            <button id="clear" class="ghost">Clear</button>
            <button id="selectAll" class="ghost">Select all</button>
          </div>

          <div class="right muted">Live updates â€” no limits.</div>

          <!-- THEME TOGGLE -->
          <div style="margin-left:12px;">
            <button id="themeToggle" class="toggle" title="Toggle theme (light / dark)">
              <span id="themeIcon">ðŸŒ™</span>
              <span id="themeLabel">Dark</span>
            </button>
          </div>
        </div>

        <div class="stats" aria-live="polite">
          <div class="stat">
            <span class="muted">Characters (code units)</span>
            <strong id="charsUnit">0</strong>
          </div>

          <div class="stat">
            <span class="muted">Visible characters (code points)</span>
            <strong id="charsCp">0</strong>
          </div>

          <div class="stat">
            <span class="muted">Words</span>
            <strong id="words">0</strong>
          </div>

          <div class="stat">
            <span class="muted">Lines</span>
            <strong id="lines">0</strong>
          </div>

          <div class="stat">
            <span class="muted">Selected (chars)</span>
            <strong id="selection">0</strong>
          </div>

          <div class="stat">
            <span class="muted">Estimated reading time</span>
            <strong id="readtime">0 min</strong>
          </div>
        </div>

        <div class="footer">
          Tips: Emojis and some complex glyphs may count as multiple code units;
          the "Visible characters" counter uses a better approximation of displayed characters.
          This tool intentionally doesn't restrict length â€” your browser/memory is the only limit.
        </div>
      </div>
    </div>
  </div>

  <script>
    // -------------------------
    // Utility: grapheme counting
    // -------------------------
    function countGraphemes(str) {
      if (typeof Intl !== 'undefined' && Intl.Segmenter) {
        try {
          const seg = new Intl.Segmenter(undefined, { granularity: 'grapheme' });
          return Array.from(seg.segment(str)).length;
        } catch (e) {
          // fallback
        }
      }
      return Array.from(str).length;
    }

    // -------------------------
    // DOM references
    // -------------------------
    const app = document.getElementById('app');
    const ta = document.getElementById('txt');
    const charsUnit = document.getElementById('charsUnit');
    const charsCp = document.getElementById('charsCp');
    const wordsEl = document.getElementById('words');
    const linesEl = document.getElementById('lines');
    const selectionEl = document.getElementById('selection');
    const readtimeEl = document.getElementById('readtime');

    const copyBtn = document.getElementById('copy');
    const clearBtn = document.getElementById('clear');
    const selectAllBtn = document.getElementById('selectAll');

    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');
    const themeLabel = document.getElementById('themeLabel');

    const THEME_KEY = 'textcalc-theme'; // localStorage key

    // -------------------------
    // Statistics updater
    // -------------------------
    function updateStats() {
      const val = ta.value;

      const units = val.length;
      const cp = countGraphemes(val);
      const words = val.trim().length ? val.trim().split(/\s+/).filter(Boolean).length : 0;
      const lines = val.length ? val.split(/\r?\n/).length : 0;

      const selStart = ta.selectionStart ?? 0;
      const selEnd = ta.selectionEnd ?? 0;
      const selLen = Math.max(0, selEnd - selStart);

      const minutes = words ? Math.ceil(words / 200) : 0;

      charsUnit.textContent = units.toLocaleString();
      charsCp.textContent = cp.toLocaleString();
      wordsEl.textContent = words.toLocaleString();
      linesEl.textContent = lines.toLocaleString();
      selectionEl.textContent = selLen.toLocaleString();
      readtimeEl.textContent = minutes + " min";
    }

    // -------------------------
    // Theme handling
    // -------------------------
    function applyTheme(theme) {
      // theme === 'dark' or 'light'
      if (theme === 'dark') {
        document.documentElement.classList.add('theme-dark');
        themeIcon.textContent = 'â˜€ï¸';
        themeLabel.textContent = 'Light';
      } else {
        document.documentElement.classList.remove('theme-dark');
        themeIcon.textContent = 'ðŸŒ™';
        themeLabel.textContent = 'Dark';
      }
      try { localStorage.setItem(THEME_KEY, theme); } catch (e) { /* ignore */ }
    }

    function toggleTheme() {
      const cur = localStorage.getItem(THEME_KEY) || 'light';
      const next = cur === 'dark' ? 'light' : 'dark';
      applyTheme(next);
    }

    // set initial theme (from localStorage or prefers-color-scheme)
    (function initTheme() {
      let saved = null;
      try { saved = localStorage.getItem(THEME_KEY); } catch (e) { /* ignore */ }

      if (saved === 'dark' || saved === 'light') {
        applyTheme(saved);
      } else {
        // fallback: respect system preference if available
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        applyTheme(prefersDark ? 'dark' : 'light');
      }
    })();

    themeToggle.addEventListener('click', toggleTheme);

    // -------------------------
    // Buttons (copy/clear/select)
    // -------------------------
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(ta.value);
        const original = copyBtn.textContent;
        copyBtn.textContent = 'Copied!';
        setTimeout(() => { copyBtn.textContent = original; }, 1000);
      } catch (e) {
        ta.select();
        document.execCommand('copy');
      }
    });

    clearBtn.addEventListener('click', () => {
      ta.value = '';
      updateStats();
      ta.focus();
    });

    selectAllBtn.addEventListener('click', () => {
      ta.select();
      updateStats();
      ta.focus();
    });

    // -------------------------
    // Live updates
    // -------------------------
    ta.addEventListener('input', updateStats);
    ta.addEventListener('select', updateStats);
    ta.addEventListener('keyup', updateStats);
    ta.addEventListener('click', updateStats);

    // initial
    updateStats();
  </script>
</body>
</html>
